<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Class XP Progress — 8‑Bit</title>
<style>
  @font-face{
    font-family: "GameFont";
    src: url("game-font.ttf") format("truetype");
    font-display: swap;
  }

  :root{
    --bg:#000; --text:#fff; --accent:#ff2a2a; --accent-d:#b00000; --border:#fff; --muted:#bbb;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family: "GameFont", monospace; image-rendering: pixelated;
    display:flex; align-items:center; justify-content:center; padding:18px;
  }

  .wrap{ width:min(900px,95vw); display:flex; flex-direction:column; gap:18px; }

  .pixel-frame{
    border:4px solid var(--border);
    box-shadow: 0 0 0 4px var(--bg) inset, 0 0 0 8px var(--border) inset;
    background:#111;
  }

  .bar-outer{ height:80px; position:relative; overflow:hidden; }
  .bar-inner{ position:absolute; inset:8px; background:#000; outline:4px solid var(--border); }
  .bar-fill{
    position:absolute; top:8px; bottom:8px; left:8px; width:0%;
    background: repeating-linear-gradient(90deg, var(--accent) 0px, var(--accent) 8px, var(--accent-d) 8px, var(--accent-d) 16px);
    transition: width .25s steps(8, end);
  }
  .bar-label{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:32px; letter-spacing:1px; text-shadow: 0 0 8px rgba(255,255,255,.25); user-select:none; }

  .panel{ padding:14px; display:grid; grid-template-columns: 1fr 1fr auto; gap:12px; align-items:end; }
  .panel.pixel-frame{ background:#111; }
  .field label{ display:block; font-size:14px; color:var(--muted); margin-bottom:6px; }
  input[type="number"]{
    width:100%; background:#000; color:var(--text); border:4px solid var(--border);
    padding:10px 8px; font-family:"GameFont", monospace; font-size:20px; outline:none;
  }
  input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
  button{
    height:46px; background:var(--accent); color:#000; border:4px solid var(--border);
    font-family:"GameFont", monospace; font-size:18px; padding:0 16px; cursor:pointer;
  }
  button:active{ transform: translateY(1px); }

  .stats{ grid-column: 1 / -1; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:16px; }
  .stats strong{ color:var(--text); }

  .scanlines{ position:fixed; inset:0; pointer-events:none; mix-blend-mode:soft-light; opacity:.08;
    background: repeating-linear-gradient( to bottom, rgba(255,255,255,.06) 0px, rgba(255,255,255,.06) 2px, rgba(0,0,0,0) 2px, rgba(0,0,0,0) 4px );
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="pixel-frame bar-outer" aria-label="XP progress">
      <div class="bar-inner"></div>
      <div class="bar-fill" id="bar"></div>
      <div class="bar-label" id="percent">0%</div>
    </div>

    <div class="pixel-frame panel">
      <div class="field">
        <label for="earned">Earned XP</label>
        <input id="earned" type="number" min="0" step="1" placeholder="e.g., 820">
      </div>
      <div class="field">
        <label for="total">Total XP</label>
        <input id="total" type="number" min="1" step="1" placeholder="e.g., 1200">
      </div>
      <div><button id="update">UPDATE</button></div>
      <div class="stats">
        <div><strong id="earnedOut">0</strong> / <strong id="totalOut">0</strong> XP</div>
        <div><strong id="level">LEVEL 0</strong></div>
      </div>
    </div>
  </div>
  <div class="scanlines"></div>

<script>
(function(){
  const $ = id => document.getElementById(id);
  const earned = $("earned"), total = $("total");
  const bar = $("bar"), percent = $("percent");
  const earnedOut = $("earnedOut"), totalOut = $("totalOut"), level = $("level");

  const params = new URLSearchParams(location.search);

  function loadInitial(){
    const e = params.get("earned") ?? localStorage.getItem("xp_earned");
    const t = params.get("total")  ?? localStorage.getItem("xp_total");
    if(e) earned.value = e;
    if(t) total.value  = t;
    update();
  }

  function levelFromPct(p){
    if(p >= 100) return 5;
    if(p >= 80)  return 4;
    if(p >= 60)  return 3;
    if(p >= 40)  return 2;
    if(p >= 20)  return 1;
    return 0;
  }
  function clamp(n,min,max){ return Math.max(min, Math.min(max, n)); }

  function update(){
    const e = Math.max(0, parseInt(earned.value || 0, 10));
    const t = Math.max(1, parseInt(total.value || 1, 10));
    const p = clamp(Math.round((e/t)*100), 0, 999);

    bar.style.width = Math.min(p, 100) + "%";
    percent.textContent = p + "%";

    earnedOut.textContent = e.toLocaleString();
    totalOut.textContent  = t.toLocaleString();

    level.textContent = "LEVEL " + levelFromPct(p);

    localStorage.setItem("xp_earned", e);
    localStorage.setItem("xp_total", t);
    document.title = `Class XP: ${p}%`;
  }

  $("update").addEventListener("click", update);
  [earned, total].forEach(inp => inp.addEventListener("keydown", e => { if(e.key === "Enter") update(); }));

  loadInitial();
})();
</script>
</body>
</html>
